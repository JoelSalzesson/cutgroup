var ward_map,ward_signups;$(document).ready(function(){0!=$("html.lt-ie9").length?($("#ward-map-container").remove(),$("#main-body-copy").removeClass("span6").addClass("span12")):$.get("assets/js/signups.json",function(b){ward_signups=b;ward_map=$K.map("#ward-map");ward_map.loadMap("assets/img/wards.svg",function(){ward_map.addLayer("chicago",{styles:{"stroke-width":"0.75px",fill:"#fff"}});doMap()})})});
function color_for_value(b){var d=["#CCFFFF","#99CCCC","#669999","#336666","#003333"],c=_.sortBy(_.uniq(_.values(ward_signups)),function(a){return a});0==c[0]&&c.shift();index_of_val=_.indexOf(c,b);color_index=Math.floor(index_of_val/c.length*d.length);return d[color_index]}
function doMap(){layer=ward_map.getLayer("chicago");for(ward in ward_signups){var b=layer.getPaths({ward:ward}),d=b[0].svgPath.node;jQuery.data(d,"signups",ward_signups[b[0].data.ward]);jQuery.data(d,"ward",b[0].data.ward)}ward_map.getLayer("chicago").style({fill:function(c){return 0==ward_signups[c.ward]?"#fff":color_for_value(ward_signups[c.ward])}});$("path.chicago").each(function(c,a){$(a).bind("mouseenter",function(){$(a).data("previous-fill-color",$(a).attr("fill"));$(a).attr("fill","#ccc")});
$(a).bind("mouseleave",function(){$(a).attr("fill",$(a).data("previous-fill-color"))});var b=$.data(a,"signups");$(a).tooltip({container:"body",animation:!1,placement:"left",title:"Ward "+$.data(a,"ward")+": "+(b||"0")+" tester"+(1==b?"":"s")})})};